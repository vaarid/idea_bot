# –°–∏—Å—Ç–µ–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Idea Bot

## üéØ –¶–µ–ª—å
–û–±–µ—Å–ø–µ—á–∏—Ç—å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –ø–æ–∫–∞ –≤–µ–¥–µ—Ç—Å—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### 1. **–¢—Ä–∏ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã**
- **PRODUCTION** - —Ä–∞–±–æ—á–∏–π –±–æ—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **DEVELOPMENT** - —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å hot reload
- **STAGING** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### 2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–±—Ä–∞–∑–æ–≤**
```
idea-bot:production    # –¢–µ–∫—É—â–∏–π —Ä–∞–±–æ—á–∏–π –æ–±—Ä–∞–∑
idea-bot:staging       # –û–±—Ä–∞–∑ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
idea-bot:development   # –û–±—Ä–∞–∑ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```

## üìã Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ**
```bash
# 1. –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ä–∞–±–æ—á–µ–≥–æ –æ–±—Ä–∞–∑–∞
docker tag idea-bot:latest idea-bot:production-backup-$(date +%Y%m%d_%H%M%S)

# 2. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –≤ —Ä–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
./scripts/dev-start.sh
```

### **–≠—Ç–∞–ø 2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –∫–æ–¥ –≤ –ø–∞–ø–∫–µ src/
# –ò–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ volume
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (5 —Å–µ–∫—É–Ω–¥)
docker-compose -f docker-compose.dev.yml restart
```

### **–≠—Ç–∞–ø 3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```bash
# –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤ dev-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
# –ï—Å–ª–∏ –≤—Å–µ –û–ö - –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ staging
./scripts/staging-deploy.sh
```

### **–≠—Ç–∞–ø 4: Staging (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º)**
```bash
# –°–æ–∑–¥–∞–µ–º staging –æ–±—Ä–∞–∑
docker build -t idea-bot:staging .

# –ó–∞–ø—É—Å–∫–∞–µ–º staging –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º
./scripts/staging-start.sh
```

### **–≠—Ç–∞–ø 5: Production Deploy**
```bash
# –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤ staging
./scripts/production-deploy.sh
```

## üõ†Ô∏è –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

### **dev-start.sh** - –ó–∞–ø—É—Å–∫ —Ä–µ–∂–∏–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```bash
#!/bin/bash
echo "üöÄ –ó–∞–ø—É—Å–∫ —Ä–µ–∂–∏–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏..."

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º production –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker stop idea-bot 2>/dev/null
docker rm idea-bot 2>/dev/null

# –ó–∞–ø—É—Å–∫–∞–µ–º dev –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å volume –¥–ª—è –∫–æ–¥–∞
docker-compose -f docker-compose.dev.yml up -d

echo "‚úÖ –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—É—â–µ–Ω"
echo "üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ src/ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä"
echo "üîÑ –î–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞: docker-compose -f docker-compose.dev.yml restart"
```

### **staging-deploy.sh** - –î–µ–ø–ª–æ–π –≤ staging
```bash
#!/bin/bash
echo "üß™ –î–µ–ø–ª–æ–π –≤ staging..."

# –°–æ–±–∏—Ä–∞–µ–º staging –æ–±—Ä–∞–∑
docker build -t idea-bot:staging .

# –ó–∞–ø—É—Å–∫–∞–µ–º staging —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º
docker run -d --name idea-bot-staging \
  --env-file .env.staging \
  -e TELEGRAM_BOT_TOKEN=$TEST_BOT_TOKEN \
  idea-bot:staging

echo "‚úÖ Staging –∑–∞–ø—É—â–µ–Ω"
echo "üß™ –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º"
```

### **production-deploy.sh** - –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
```bash
#!/bin/bash
echo "üöÄ –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω..."

# –°–æ–∑–¥–∞–µ–º —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–µ–≥–æ production
docker tag idea-bot:latest idea-bot:backup-$(date +%Y%m%d_%H%M%S)

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º production
docker stop idea-bot
docker rm idea-bot

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º staging –≤ production
docker tag idea-bot:staging idea-bot:latest

# –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π production
docker run -d --name idea-bot \
  --restart unless-stopped \
  --env-file .env \
  -v "${PWD}/data:/app/data" \
  -v "${PWD}/logs:/app/logs" \
  idea-bot:latest

echo "‚úÖ Production –æ–±–Ω–æ–≤–ª–µ–Ω"
echo "üîÑ –û—Ç–∫–∞—Ç: ./scripts/rollback.sh"
```

### **rollback.sh** - –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏
```bash
#!/bin/bash
echo "‚è™ –û—Ç–∫–∞—Ç –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏..."

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π production
docker stop idea-bot
docker rm idea-bot

# –ù–∞—Ö–æ–¥–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–π backup
BACKUP_IMAGE=$(docker images --format "table {{.Repository}}:{{.Tag}}" | grep "idea-bot:backup" | head -1)

# –ó–∞–ø—É—Å–∫–∞–µ–º backup
docker run -d --name idea-bot \
  --restart unless-stopped \
  --env-file .env \
  -v "${PWD}/data:/app/data" \
  -v "${PWD}/logs:/app/logs" \
  $BACKUP_IMAGE

echo "‚úÖ –û—Ç–∫–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω"
```

## üìÅ –§–∞–π–ª—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### **docker-compose.dev.yml** - –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
```yaml
services:
  idea-bot-dev:
    build: .
    container_name: idea-bot-dev
    restart: "no"
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - DATABASE_URL=sqlite:///data/ideas.db
      - LOG_LEVEL=DEBUG
    volumes:
      # Hot reload - –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ —Å—Ä–∞–∑—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
      - ./src:/app/src
      - ./config:/app/config
      - ./data:/app/data
      - ./logs:/app/logs
    networks:
      - idea-bot-dev-network
```

### **docker-compose.staging.yml** - –†–µ–∂–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```yaml
services:
  idea-bot-staging:
    build: .
    container_name: idea-bot-staging
    restart: "no"
    environment:
      - TELEGRAM_BOT_TOKEN=${TEST_BOT_TOKEN}
      - DATABASE_URL=sqlite:///data/ideas_staging.db
      - LOG_LEVEL=INFO
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    networks:
      - idea-bot-staging-network
```

## üîÑ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### **1. –ù–∞—á–∞–ª–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
```bash
./scripts/dev-start.sh
# –í—Ä–µ–º—è: 30 –º–∏–Ω—É—Ç (–æ–¥–∏–Ω —Ä–∞–∑)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å hot reload
```

### **2. –ò—Ç–µ—Ä–∞—Ü–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –∫–æ–¥
# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker-compose -f docker-compose.dev.yml restart
# –í—Ä–µ–º—è: 5 —Å–µ–∫—É–Ω–¥
```

### **3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```bash
./scripts/staging-deploy.sh
# –í—Ä–µ–º—è: 30 –º–∏–Ω—É—Ç (—Å–±–æ—Ä–∫–∞ staging –æ–±—Ä–∞–∑–∞)
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º –±–æ—Ç–æ–º
```

### **4. –î–µ–ø–ª–æ–π –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω**
```bash
./scripts/production-deploy.sh
# –í—Ä–µ–º—è: 1 –º–∏–Ω—É—Ç–∞
# –†–µ–∑—É–ª—å—Ç–∞—Ç: –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π production
```

## ‚ö° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã

### **–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
- **Hot reload**: 5 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 30 –º–∏–Ω—É—Ç
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: dev + production –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ë—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç**: 1 –º–∏–Ω—É—Ç–∞

### **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- **–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ backup'–æ–≤
- **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: staging —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º
- **Zero-downtime**: production —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### **–£–¥–æ–±—Å—Ç–≤–æ**
- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ß–µ—Ç–∫–∏–π workflow**: –ø–æ–Ω—è—Ç–Ω—ã–µ —ç—Ç–∞–ø—ã
- **–ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**: –æ—Ç–∫–∞—Ç –∑–∞ 1 –º–∏–Ω—É—Ç—É

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞

### **1. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–º–∞–π production**
- –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π backup –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- –¢–µ—Å—Ç–∏—Ä—É–π –≤ staging –ø–µ—Ä–µ–¥ production
- –ò–º–µ–π –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞

### **2. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º**
- **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞**: dev —Ä–µ–∂–∏–º —Å volumes
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**: staging —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º
- **–ü—Ä–æ–¥–∞–∫—à–µ–Ω**: —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –∫–æ–¥

### **3. –°–ª–µ–¥–∏ –∑–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏**
- –û—á–∏—â–∞–π —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–∑—ã: `docker image prune`
- –ú–æ–Ω–∏—Ç–æ—Ä—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
- –£–¥–∞–ª—è–π –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞**
```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# –õ–æ–≥–∏ production
docker logs idea-bot

# –õ–æ–≥–∏ development
docker logs idea-bot-dev

# –õ–æ–≥–∏ staging
docker logs idea-bot-staging
```

### **–û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤**
```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–∑–æ–≤
docker image prune -a

# –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker container prune

# –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞
docker system df
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–í—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–∫—Ä–∞—â–µ–Ω–æ —Å 30 –º–∏–Ω—É—Ç –¥–æ 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é!**

- ‚úÖ Production —Ä–∞–±–æ—Ç–∞–µ—Ç 24/7
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–ø–ª–æ–π
- ‚úÖ –ù–∞–¥–µ–∂–Ω—ã–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
