# vision.md

## Архитектура системы

### Выбранный подход
**Python-бот + гибридная архитектура**  
- **План А**: Python-бот как основа.  
- **План Б**: Make-прототип как резервный вариант【49†source】.

---

## Компоненты системы
```
Telegram → Python Core → Data Layer
   ↓          ↓              ↓
Whisper     Scheduler     Analytics
```

- **Telegram Bot** (python-telegram-bot) — интерфейс.  
- **Python Core** (FastAPI/Flask) — бизнес-логика.  
- **Data Layer** (SQLite / Sheets) — хранение идей.  
- **Whisper API** — распознавание речи.  
- **Scheduler (APScheduler)** — утренние дайджесты.  
- **Analytics (Pandas/LLM)** — статистика и streak.

---

## Технологический стек
- **Язык**: Python 3.11+.  
- **Библиотеки**: python-telegram-bot, FastAPI, APScheduler, Pandas.  
- **БД**: SQLite (MVP), далее — PostgreSQL.  
- **AI**: Whisper API, Ollama (основной LLM), OpenAI API (резерв).  
- **Инфраструктура**: Docker, CI/CD pipeline (GitHub Actions).

---

## Архитектурные принципы
1. **Простота** — минимальная сложность для MVP.  
2. **Модульность** — разделение по слоям и независимым сервисам.  
3. **Масштабируемость** — миграция на более мощные БД, многопользовательский режим.  
4. **Надёжность** — логирование, fallback-стратегии.  
5. **Безопасность** — защита токенов, валидация входящих данных.

---

## Паттерны проектирования
- **Repository Pattern** — слой данных.  
- **Command Pattern** — выполнение команд (/save, /digest).  
- **Observer Pattern** — уведомления о событиях (сохранение, streak).  
- **Service Layer** — бизнес-логика поверх репозиториев.

---

## Метрики и мониторинг
- ≥ 90% идей сохраняется.  
- 100% дайджестов вовремя.  
- Время отклика < 2 секунд.  
- 0 прерываний streak из-за ошибок.  
- UX: ≤ 2 клика для сохранения идеи, < 5 секунд генерации дайджеста.

**Логирование:** ошибки Whisper, таймауты Telegram, статистика команд, нагрузка.

---

## План развития
- **Итерация 1**: текстовые команды, сохранение идей, простой дайджест.  
- **Итерация 2**: интеграция Whisper API, streak, базовая аналитика.  
- **Итерация 3**: Sheets, расширенные экспорты, статистика.  
- **Будущее**: мобильное приложение, геймификация, интеграции с Trello/Notion/Slack.

---

## Дополнения и рекомендации
- Добавить **user flow** (вечер — идея → база → утро — дайджест).  
- Составить **таблицу рисков**: сервис → ошибка → fallback.  
- Подготовить **диаграммы архитектуры** (Mermaid/PlantUML) для портфолио.
